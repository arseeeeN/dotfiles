#!/bin/sh

# Install yay if it doesn't exist
if ! command -v yay &> /dev/null
then
    pacman -S --needed git base-devel
    git clone https://aur.archlinux.org/yay.git
    cd yay
    makepkg -si
    cd ..
    rm -rf ./yay
fi

vars_file_path=~/.config/nushell/vars.nu
if [[ ! -f "$vars_file_path" ]]; then
    source ~/.local/share/chezmoi/generate_env_vars.sh
fi

# Install all headless packages
yay -Syu --needed \
    git \
    nushell \
    neovim \
    zellij \
    bat \
    fd \
    fzf \
    jq \
    imagemagick \
    docker \
    docker-compose \
    docker-buildx \
    helm \
    kubectl \
    kubie \
    k9s \
    gomplate-bin

# If not a headless install then also install all GUI related stuff
{{ $headless := eq (env "CHEZMOI_HEADLESS") "true" }}
{{ if not $headless }}
yay -Syu --needed \
    wev \
    wireplumber \
    ffmpeg \
    mpv \
    ly \
    blight \
    sway \
    swaybg \
    grim \
    slurp \
    mako \
    alacritty \
    noto-fonts \
    noto-fonts-emoji \
    ttf-jetbrains-mono \
    ttf-jetbrains-mono-nerd
{{ end }}
